<!DOCTYPE html>
<html>
    <head>
    <!-- Title -->
    
    <title>
        [C++]C++11/14 类型系统 | Big Wolf’s Blog
    </title>
    
    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">
    
    <!-- Meta & INfo -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#FF8247">
    <meta name="author" content="与狼同行">
    <meta name="description" content="null">
    <meta name="keywords" content="null">
    
    <!--iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">
    
    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Big Wolf’s Blog">
    
    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://chenmingjia.github.io">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="[C++]C++11/14 类型系统 | Big Wolf’s Blog">
    <meta property="og:description" content="null">
    
     <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">
        
        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->
    
    <!-- Import CSS -->
    <link rel="stylesheet" href="/css/material.min.css">
    <link rel="stylesheet" href="/css/style.min.css">
    <!-- Config CSS -->

<!-- Theme Background -->

    <style>
        body{
            background-color: #F5F5F5
        }
		
        #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
            background-color: #fff;
        }
		
        #scheme-Paradox .MD-burger-layer {
            background-color: #666;
        }
		
        #scheme-Paradox .material-back{
            color: #666;
        }
		
        .material-layout .material-post>.material-nav,
		.material-layout .material-index>.material-nav,
        .material-nav a,
        #scheme-Paradox .material-post_container .material-back{
            color: #666;
        }
    </style>


<!-- Fade Effect -->

    <style>
        .fade {
            transition: all 800ms linear;
            -webkit-transform: translate3d(0,0,0);
            -moz-transform: translate3d(0,0,0);
            -ms-transform: translate3d(0,0,0);
            -o-transform: translate3d(0,0,0);
            transform: translate3d(0,0,0);
            opacity: 1;
        }

        .fade.out{
            opacity: 0;
        }
    </style>


<!-- Other Styles -->
<style>
	body, html{
		font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
	}
	
    a{
        color: #FF8C69
    }
    
    .mdl-card__media,
    #search-label,
    #search-form-label:after,
    #scheme-Paradox .hot_tags-count,
    #scheme-Paradox .sidebar_archives-count,
    #scheme-Paradox .sidebar-colored .sidebar-header,
    #scheme-Paradox .sidebar-colored .sidebar-badge{
        background-color: #FF8247 !important
    }
    
    #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus{
        color: #FF8247 !important
    }
    
    #post_entry-right-info,
    .sidebar-colored .sidebar-nav li:hover > a,
    .sidebar-colored .sidebar-nav li:hover > a i,
    .sidebar-colored .sidebar-nav li > a:hover,
    .sidebar-colored .sidebar-nav li > a:hover i,
    .sidebar-colored .sidebar-nav li > a:focus i,
    .sidebar-colored .sidebar-nav > .open > a,
    .sidebar-colored .sidebar-nav > .open > a:hover,
    .sidebar-colored .sidebar-nav > .open > a:focus,
    #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a{
        color: #FF8247 !important
    }
    
    .fab{
        background: #FF8247 !important
    }
</style>
	<script src="/js/jquery.min.js"></script>
	
	<!-- UC Browser Compatible-->
	<script>
		var agent = navigator.userAgent.toLowerCase();
		if(agent.indexOf('ucbrowser')>0) {
			document.write('<link rel="stylesheet" href="/css/uc.css">');
		   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
		}
	</script>
    
    <!-- Custom Head -->
    
</head>
	
	

    <body id="scheme-Paradox">

		
        <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
				
			
			
            <!-- Main Container -->
            <main class="material-layout__content" id="main">
				
                <!-- Top Anchor -->
                <div id="top"></div>
				
				
                <!-- Hamburger Button -->
                <button class="MD-burger-icon sidebar-toggle">
                    <span class="MD-burger-layer"></span>
                </button>
				
				
                
	<!-- Back Button -->
	<div class="material-back" id="backhome-div" tabindex="0">
		<a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" href="#" onclick="window.history.back();return false;" target="_self" role="button" data-upgraded=",MaterialButton,MaterialRipple">
			<i class="material-icons" role="presentation">arrow_back</i>
			<span class="mdl-button__ripple-container">
				<span class="mdl-ripple"></span>
			</span>
		</a>
	</div>			


<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">
        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
	<!-- Paradox Post Header -->
	
		<!-- Custom Thumbnail -->
		<div class="post_thumbnail-custom mdl-card__media mdl-color-text--grey-50" style="background-image:url(http://img0w.pconline.com.cn/pconline/1406/09/spcgroup/width_640,qua_30/4906839_006.jpg)">
	
        <p class="article-headline-p">
            [C++]C++11/14 类型系统
        </p>
    </div>

	

				
				
					<!-- Paradox Post Info -->
					<div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">
    
    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>与狼同行</strong>
        <span>11月 20, 2016</span>
    </div>
    
    <div class="section-spacer"></div>
	
    <!-- Favorite -->
<!--
    <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
        <i class="material-icons" role="presentation">favorite</i>
        <span class="visuallyhidden">favorites</span>
    </button>
-->
    
    <!-- Tags (bookmark) -->
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/">undefined</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/">undefined</a>
    </ul>
    
    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    
    
    
    
    
    <!-- Share Twitter -->
    <a class="post_share-link" href="https://twitter.com/intent/tweet?text=[C++]C++11/14 类型系统&url=http://chenmingjia.github.io//20161121  操作系统篇.html&via=与狼同行" target="_blank">
        <li class="mdl-menu__item">
            分享到 Twitter
        </li>
    </a>
    
    <!-- Share Google+ -->
    <a class="post_share-link" href="https://plus.google.com/share?url=http://chenmingjia.github.io//20161121  操作系统篇.html" target="_blank">
        <li class="mdl-menu__item">
            分享到 Google+
        </li>
    </a>
    
    <!-- Share Weibo -->
    <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=[C++]C++11/14 类型系统&url=http://chenmingjia.github.io//20161121  操作系统篇.html&pic=&searchPic=false&style=simple" target="_blank">
        <li class="mdl-menu__item">
            分享到微博
        </li>
    </a>
</ul>
</div>
				

                <!-- Post Content -->
                <div id="post-content" class="markdown-Github mdl-color-text--grey-700 mdl-card__supporting-text fade out">
	
		<p>本文整理自 刘光聪先生的演讲</p>
<h1 id="一、类型系统"><a href="#一、类型系统" class="headerlink" title="一、类型系统"></a>一、类型系统</h1><h2 id="1-1-auto"><a href="#1-1-auto" class="headerlink" title="1.1 auto"></a>1.1 auto</h2><p>移动语义修改了C++内核。<br>C++作为一门强类型语言，在新版本中增加了自动类型推导的功能，而在另外一个基于jvm的语言Scala，其实它们使用的类型推导的算法是一致的。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/712028-d2a590ed8aee3637.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="124C24CB-7485-468F-BD67-A8380F83FC2D.png"></p>
<p><strong>由于map在C++98中的key是const的，不可修改的，所以pair<string，int>在ranged for的时候隐形地产生一个临时变量pair<const string，int="">来赋值，其中string和int类型进行了move操作。</const></string，int></strong></p>
<p><img src="http://upload-images.jianshu.io/upload_images/712028-d81166d0a39ccad0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="AC7308FB-67FF-4841-B57E-7C935E4729A0.png"><br>这里使用auto也可以根据words参数自动的推断出const的语义。<br><strong>所以auto的类型推演约等于模板的推演方式。</strong></p>
<p><img src="http://upload-images.jianshu.io/upload_images/712028-1a1c9d9287d4298a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="6DE1FEA0-3335-4461-8043-FCBA549B0224.png"><br>假如expr是const的，当第一句进行值拷贝时，var不是const的。所以需要显示的加上const表示const语义。<br>而第三句使用引用auto,这就是值类型和引用类型不一样的地方，自动变成了const类型。而第4句显式的加上const也没有问题，完全是个人习惯的问题。<br>到了第5句，universal renference，这个在11中属于右值引用。</p>
<p>##右值引用</p>
<p><img src="http://upload-images.jianshu.io/upload_images/712028-8970218424b62ed7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="8C9D538D-A455-4CED-9B9D-A3DE53980B70.png"><br>这里的关键是r1如何推演出r2的类型，记住这里r1是左值，它是引用。r1就是i的别名。所以就相当于i推演r2。所以r2也是int&amp;。所有的引用变量都是左值。</p>
<p>##Universal Renference</p>
<p><img src="http://upload-images.jianshu.io/upload_images/712028-f13d06776ca7f44d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="F1E33C7B-4AF5-4D41-AB7F-C5DFCD046014.png"><br>Universal Renference的推导规则是左值推导左值引用。如果是右值就推导右值引用。<br>在C++11时，所有的引用都是左值引用。那么为什么要推出右值引用？因为在C++98时会出现大量的对象拷贝，比如说vector的空间不足，假如空间扩充2倍，原来的方式就会新建一块新的内存，然后一个个copy，最后把旧的vector给delete。<br>然而这样的方式太过于浪费，所以C++11提出了move的概念，即a扩到b大小时，我不新建一块双倍内存，而是新建一块小内存，然后在原有内存a的基础上，指针指向b内存。这就是C++11的move的概念。</p>
<p>##特例</p>
<p><img src="http://upload-images.jianshu.io/upload_images/712028-9bb82bc008694c3c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="8C698A31-2CD8-4F67-9D16-D70B6D139EE1.png"><br>第一个例子，{10}可以推导出initiliazer list。但是第二句就失败了，因为它向下转型了。int到double时会出现精度扩展，这是个比较危险的行为。但是它支持向上转型。</p>
<p>##函数推导<br><img src="http://upload-images.jianshu.io/upload_images/712028-ab6ba4037eec4ff3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="649B043E-BC23-4240-9CB4-4ACF298CD7B6.png"><br>函数推导时第一个例子，会变成兼容c的风格，从函数类型退化为指向函数的指针。而加上引用后，f2就是函数类型，这也是需要注意的地方。</p>
<p>##数组推导</p>
<p><img src="http://upload-images.jianshu.io/upload_images/712028-31537cb3b1e6977b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>同理还有数组的推导过程，decltype(name)是数组类型，但是赋值给auto时，会退化为char类型，但是使用引用又变成了正确的类型。</p>
<p>##Lambda</p>
<p><img src="http://upload-images.jianshu.io/upload_images/712028-9c2b5faa2a60a8f1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="D6CEFBEB-9981-4747-AE1C-0F035834086B.png"><br>这两个方式是等价的，这种推导方式可以直接达到泛型函数的效果。这也是新出的新特性。<br>注意这里的isEven是右值。<br>所以说，auto的类型推演，其实跟模板推演是一致的。</p>
<h2 id="1-2-decltype"><a href="#1-2-decltype" class="headerlink" title="1.2 decltype"></a>1.2 decltype</h2><p>这是C++98的写法。<br><img src="http://upload-images.jianshu.io/upload_images/712028-b28188b221e903e1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="B00008EA-D43A-4B25-A6C3-51A4E497CD4E.png"><br>这是C++11的写法。将decltype放置到尾部。所以现代语言普遍都会把返回类型放到后面。<br><img src="http://upload-images.jianshu.io/upload_images/712028-367061c4f4ef1d38.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>这是C++14的写法。可能编译器觉得像11那样写都太麻烦了，索性把这个工作也给简化了。<br><img src="http://upload-images.jianshu.io/upload_images/712028-ec895003f90cc3b3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="54261D3A-9076-4CC3-A2DE-64DDCCC16DD2.png"><br>如果我们的返回类型是引用类型，但由于auto是值语义的，程序这样一来会挂掉。所以我们拥有decltype(auto)的写法来防止这个问题。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/712028-bbb672155f6fe6c9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="C05BCA20-9010-48E5-A136-485B3FEBF59A.png"></p>
<h1 id="二、右值引用"><a href="#二、右值引用" class="headerlink" title="二、右值引用"></a>二、右值引用</h1><h2 id="2-1什么是左值？什么是右值？"><a href="#2-1什么是左值？什么是右值？" class="headerlink" title="2.1什么是左值？什么是右值？"></a>2.1什么是左值？什么是右值？</h2><ol>
<li>左值是持有的。<br>拥有name，可以取地址。<br>比如以下操作符返回的是引用，那么就是左值:[],+=,&amp;=,前置++</li>
<li>右值是短暂的。<br>比如说匿名临时对象，<br>字面量<br>static_cast这种类型转换。<br>返回的是值类型，那么就是值类型:+,&lt;,&amp;,++后置<br><strong>右值引用指向了一个即将被销毁的对象，然后把对象move给右值引用。所以该对象一定要是可以析构的</strong><br>虽然这个变量被定义成右值引用，但是变量本身是左值的。<h2 id="2-2举例说明"><a href="#2-2举例说明" class="headerlink" title="2.2举例说明"></a>2.2举例说明</h2><strong>左值引用例子</strong><br><img src="http://upload-images.jianshu.io/upload_images/712028-04da0c5b1e825618.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="F6F18D88-2852-46A6-BE20-A5C2A55E1C40.png"><br><strong>右值引用例子<br><img src="http://upload-images.jianshu.io/upload_images/712028-988efb048da05956.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="84E43DA4-B139-4EEA-885A-3F0A4C5A505C.png"></strong></li>
</ol>
<p><strong>所以通用引用既可以指向左值也可以指向右值，它可以绑定const也可以不绑定const，但没有什么意义</strong></p>
<h2 id="2-3-右值引用-amp-通用指针"><a href="#2-3-右值引用-amp-通用指针" class="headerlink" title="2.3 右值引用&amp;通用指针"></a>2.3 右值引用&amp;通用指针</h2><p><img src="http://upload-images.jianshu.io/upload_images/712028-de77efa5b7b8be89.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="1662BC90-F862-44C4-AC6A-8A17DA5310B4.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/712028-c1d08d5e9ecd996b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="C69DC955-F741-4D17-94A0-92143F8DD865.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/712028-e653a663629fd4b5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="92CA5793-ED66-4618-BB0A-0A41C7FA24E1.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/712028-cad61c10be5085e5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="E0A7188B-5536-438E-9E7E-578EEFF51E79.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/712028-5b5a63bc073a75f4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="C968EA05-059A-4C7D-9D86-C11D59E6A94E.png"><br>这里的move是inline的，所以没有任何的运行时成本，但它并没有做任何的move操作。因为此处是一个universal reference，既可以传入左值也可以是右值。但是return的是一个右值引用。所以很多人建议它改成rReference cast。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/712028-71659940708b03af.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="
![593590E7-C227-4563-A0D3-1E35D9B2C663.png](http://upload-images.jianshu.io/upload_images/712028-8ef40279191e7da1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)"></p>
<p>##三.移动语义<br>移动语义<br>无名右值引用和具名右值引用的引入主要是为了解决移动语义问题。<br>移动语义问题是指在某些特定情况下（比如用右值来赋值或构造对象时）如何采用廉价的移动语义替换昂贵的拷贝语义的问题。<br>移动语义（move semantics）是指某个对象接管另一个对象所拥有的外部资源的所有权。移动语义需要通过移动（窃取）其他对象所拥有的资源来完成。移动语义的具体实现（即一次that对象到this对象的移动（move））通常包含以下若干步骤：<br>如果this对象自身也拥有资源，释放该资源<br>将this对象的指针或句柄指向that对象所拥有的资源<br>将that对象原本指向该资源的指针或句柄设为空值<br>上述步骤可简单概括为①释放this（this非空时）②移动that<br>移动语义通常在移动构造器和移动赋值运算符中得以具体实现。两者的区别在于移动构造对象时this对象为空因而①释放this无须进行。</p>
<p>与移动语义相对，传统的拷贝语义（copy semantics）是指某个对象拷贝（复制）另一个对象所拥有的外部资源并获得新生资源的所有权。拷贝语义的具体实现（即一次that对象到this对象的拷贝（copy））通常包含以下若干步骤：<br>如果this对象自身也拥有资源，释放该资源<br>拷贝（复制）that对象所拥有的资源<br>将this对象的指针或句柄指向新生的资源<br>如果that对象为临时对象（右值），那么拷贝完成之后that对象所拥有的资源将会因that对象被销毁而即刻得以释放<br>上述步骤可简单概括为①释放this（this非空时）②拷贝that③释放that（that为右值时）<br>拷贝语义通常在拷贝构造器和拷贝赋值运算符中得以具体实现。两者的区别在于拷贝构造对象时this对象为空因而①释放this无须进行。</p>
<p>比较移动语义与拷贝语义的具体步骤可知，在赋值或构造对象时，<br>如果源对象that为左值，由于两者效果不同（移动that ≠ 拷贝that），此时移动语义不能用来替换拷贝语义。<br>如果源对象that为右值，由于两者效果相同（移动that ＝ 拷贝that ＋ 释放that），此时廉价的移动语义（通过指针操作来移动资源）便可以用来替换昂贵的拷贝语义（生成，拷贝然后释放资源）。<br>由此可知，只要在进行相关操作（比如赋值或构造）时，采取适当的左右值重载策略区分源对象的左右值属性，根据其左右值属性分别采用拷贝语义和移动语义，移动语义问题便可以得到解决。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/712028-5709213bb08ee60c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="753408F1-210E-4BFF-AADA-F72C052870FC.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/712028-f7a44c63e23b1ffd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="38BF5773-0A99-43FA-8F0B-89F8A60377E2.png"></p>
<p>所以不要使用IDE默认创建一个类，比如很多应该执行move语义的操作，你会发现被copy语义给取代，原因就是你创建了一个空的destructor，它把move constructor给delete了。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/712028-3c5a5845bb57bd5b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="047C52CC-718F-4FA7-BD7C-D666EF0E26F8.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/712028-1b039b34ceef3df6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>第一个add是copy语义，而第二个是move语义。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/712028-12d80fbb8c4a2308.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="46F6ED8E-5C7A-4D41-9A0B-03C70E7F5567.png"><br>这个例子代表有时候我们为了代码的简洁性，会考虑使用const还是pass by value，如果使用pass by value，我们可以拥有简洁性，而且我们可以发现右值引用只是进行了2次move constructor，比普通的const 引用多了一个move操作，成本依然十分接近。</p>
<p>#四、Perfect Forward</p>
<p><img src="http://upload-images.jianshu.io/upload_images/712028-943da80d8b265e41.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="CD6E80DD-7DB3-4911-BAD2-96420E3858A8.png"><br>进左值出右值，没有运行时成本。<br><img src="http://upload-images.jianshu.io/upload_images/712028-c29b7339ee993ff9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="BDB7FCC2-5B48-4617-99F6-032BCB8AFCC2.png"><br>这是forward典型的应用场景，</p>

	
	
	
	
</div>
				
				

                <!-- Post Comments -->
                
    <!-- 使用多说评论 -->
    <link rel="stylesheet" href="/css/duoshuo.min.css">
<style>
    #ds-thread #ds-reset .ds-post-button{
        background-color: #FF8247 !important;
    }
    #ds-wrapper #ds-reset .ds-icons-32{
        background-color: #FF8247 !important;
    }
    #ds-reset .ds-highlight {
        color: #FF8247 !important;
    }
</style>
<div id="comments">
    <!-- 多说评论框 start -->
        <div class="ds-thread" data-thread-key="undefined" data-title="[C++]C++11/14 类型系统" data-url="http://chenmingjia.github.io//20161121  操作系统篇.html"></div>
    <!-- 多说评论框 end -->
</div>



            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    
    <!-- Prev Nav -->
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
</nav>
        </div>
    </div>

				
				
					<!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay "></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored  sidebar-fixed-left" role="navigation">
	<div id="sidebar-main">
	    <!-- Sidebar Header -->
		<div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
    <i class="material-icons">clear_all</i>
    <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="与狼同行's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        youremail@email.com
        <b class="caret"></b>
    </a>
</div>

		<!-- Sidebar Navigation  -->
		<ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
			
                <li>
                    <a href="#" target="_blank" title="Email Me">
						<i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    <li id="sidebar-first-li">
        <a href="/" target="_self">
            <i class="material-icons sidebar-material-icons">home</i>
             主页
        </a>
    </li>

    <!-- I'm Feeling Lucky -->
<!--
    <li class="dropdown">
        <a href="" target="_self">
            <i class="material-icons sidebar-material-icons">explore</i>
             sidebar.imlucky
        </a>
    </li>
-->

	
    <!-- Archives  -->
    <li class="dropdown">
        <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
            <i class="material-icons sidebar-material-icons">inbox</i>
             归档
            <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
            <li>
            <a class="sidebar_archives-link" href="/archives/2016/11/">十一月 2016<span class="sidebar_archives-count">11</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/10/">十月 2016<span class="sidebar_archives-count">1</span></a>
        </ul>
    </li>

    <!-- Divider -->
    <li class="divider"></li>


    <!-- Pages  -->
	
	
	
		<li>
			<a href="/about" title="关于博主">
				关于博主
			</a>
		</li>
	
		<li>
			<a href="/links/" title="友情链接">
				友情链接
			</a>
		</li>
	
		<li>
			<a href="/timeline/" title="时间轴归档">
				时间轴归档
			</a>
		</li>
	
		<li>
			<a href="/gallery/" title="图库">
				图库
			</a>
		</li>
	
		<li>
			<a href="/tags/" title="标签云">
				标签云
			</a>
		</li>
	

    <!-- Article Numebr  -->
    <li>
        <a href="#">
             文章总数
             <span class="sidebar-badge">12</span>
        </a>
    </li>
</ul>

		<!-- Sidebar Divider -->
		<div class="sidebar-divider"></div>

		<!-- Sidebar Footer -->
		<!-- 
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持。 :) 
-->

<!-- Theme Material -->
<a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
	<div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
		主题 - Material
		<span class="sidebar-badge badge-circle">i</span>
	</div>
</a>

<!-- Help & Support -->
<!--
<a href="mailto:hiviosey@gmail.com" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
		sidebar.help
		<span class="mdl-button__ripple-container">
			<span class="mdl-ripple"></span>
		</span>
	</div>
</a>
-->

<!-- Feedback -->
<!--
<a href="https://github.com/viosey/hexo-theme-material/issues" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.feedback
                    <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>
-->

<!-- Abount Theme -->
<!--
<a href="https://blog.viosey.com/index.php/Material.html" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.about_theme
        <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>-->

	</div>
    
    <!-- Sidebar Sponsor -->
    


</aside>

				
				
				<!-- Floating Action Button -->
<div class="fabs">
    <a href="#top" class="fab toTop">
        <i class="material-icons">expand_less</i>
    </a>
    
    
    
    
    
    <a href="#bottom" class="fab toBottom">
        <i class="material-icons">keyboard_arrow_down</i>
    </a>
    
    <a id="prime" class="fab">
        <i class="material-icons prime-i-add">add</i>
    </a>
</div>
				
				<!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
	
	
		<!-- Paradox Footer Left Section -->
		<div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
    
    
    <!-- Facebook -->
    
    
    
    <!-- Google + -->
    
    
    
    <!-- Weibo -->
    
    
    
    <!-- Instagram -->
    
    
    
    <!-- Tumblr -->
    
    
    
    <!-- Github -->
    
    <a href="https://www.github.com/chenmingjia" target="view_window"><button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-github.png);">
        <span class="visuallyhidden">Github</span>
    </button></a>
    
</div>


		<!--Copyright-->
		<div id="copyright">Copyright&nbsp;©&nbsp;<script type="text/javascript">var fd = new Date();document.write(fd.getFullYear());</script>&nbsp;Big Wolf’s Blog</div>

		<!-- Paradox Footer Right Section -->

		<!-- 
		I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright.
		It will not impact the appearance and can give developers a lot of support :)

		很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
		它不会影响美观并可以给开发者很大的支持。 :) 
		-->

		<div class="mdl-mini-footer--right-section">
			<div>
				<div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
				<div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
			</div>
		</div>
	
    
</footer>
                
				<!-- Import File -->
<script src="/js/js.min.js"></script>
<script src="/js/nprogress.js"></script>

<script type="text/javascript">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    
    $('#nprogress .bar').css({
        'background': '#FF8247'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #FF8247, 0 0 15px #FF8247'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#FF8247',
        'border-left-color': '#FF8247'
    });
    
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>








    <!-- 多说公共 js 代码 start -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:"2231132"};
        (function() {
            var ds = document.createElement('script');
            ds.type = 'text/javascript';ds.async = true;
            ds.src = 'https://static.duoshuo.com/embed.js';
            ds.charset = 'UTF-8';
            (document.getElementsByTagName('head')[0] 
             || document.getElementsByTagName('body')[0]).appendChild(ds);
        })();
    </script>
    <!-- 多说公共 js 代码 end -->







	<script>
	var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        success: function( xmlResponse ) {
            // get the contents from search data
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var str='<ul class=\"search-result-list\">';                
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length <= 0) {
                    return;
                }
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        str += "<li><a href='"+ data_url +"' class='search-result-title' target='_blank'>"+ data_title;
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out characters
                            var start = first_occur - 6;
                            var end = first_occur + 6;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 10;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substr(start, end); 
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<em class=\"search-keyword\">"+keyword+"</em>");
                            })
                            str += "<p class=\"search-result\">" + match_content +"...</p>" +"</a>";
                        }
                    }
                })
                $resultContent.innerHTML = str;
            })
        }
    })
}
</script>

	<script>
		var search_path = "search.xml";
		if (search_path.length == 0) {
		search_path = "search.xml";
		}
		var path = "/" + search_path;
		searchFunc(path, 'search', 'local-search-result');
	</script>






            </main>
        </div>
		
    </body>
		
	
</html>
